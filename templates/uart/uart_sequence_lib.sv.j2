//------------------------------------------------------------------------------
// UART Sequence Library
// Auto-generated by VerifAI
//------------------------------------------------------------------------------

//==============================================================================
// Base Sequence
//==============================================================================

class uart_base_seq extends uvm_sequence #(uart_seq_item);
    
    `uvm_object_utils(uart_base_seq)
    
    function new(string name = "uart_base_seq");
        super.new(name);
    endfunction
    
    task body();
        `uvm_info("UART_SEQ", "Base sequence - override in derived class", UVM_MEDIUM)
    endtask
    
endclass : uart_base_seq

//==============================================================================
// Single Byte TX Sequence
//==============================================================================

class uart_single_tx_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_single_tx_seq)
    
    rand logic [{{ data_bits }}-1:0] tx_data;
    
    function new(string name = "uart_single_tx_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        item = uart_seq_item::type_id::create("item");
        start_item(item);
        
        if (!item.randomize() with {
            op == UART_TX;
            data == tx_data;
        }) `uvm_error("UART_SEQ", "Randomization failed")
        
        finish_item(item);
        
        `uvm_info("UART_SEQ", $sformatf("Sent byte: 0x%02h", tx_data), UVM_MEDIUM)
    endtask
    
endclass : uart_single_tx_seq

//==============================================================================
// Random TX Sequence
//==============================================================================

class uart_random_tx_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_random_tx_seq)
    
    rand int num_bytes;
    
    constraint c_num_bytes {
        num_bytes inside {[1:100]};
    }
    
    function new(string name = "uart_random_tx_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        `uvm_info("UART_SEQ", $sformatf("Random TX sequence: %0d bytes", num_bytes), UVM_MEDIUM)
        
        repeat (num_bytes) begin
            item = uart_seq_item::type_id::create("item");
            start_item(item);
            
            if (!item.randomize() with { op == UART_TX; })
                `uvm_error("UART_SEQ", "Randomization failed")
            
            finish_item(item);
        end
    endtask
    
endclass : uart_random_tx_seq

//==============================================================================
// String TX Sequence
//==============================================================================

class uart_string_tx_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_string_tx_seq)
    
    string tx_string = "Hello UART!";
    
    function new(string name = "uart_string_tx_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        `uvm_info("UART_SEQ", $sformatf("Sending string: \"%s\"", tx_string), UVM_MEDIUM)
        
        foreach (tx_string[i]) begin
            item = uart_seq_item::type_id::create("item");
            start_item(item);
            
            if (!item.randomize() with {
                op == UART_TX;
                data == tx_string[i];
            }) `uvm_error("UART_SEQ", "Randomization failed")
            
            finish_item(item);
        end
        
        // Send newline
        item = uart_seq_item::type_id::create("item");
        start_item(item);
        if (!item.randomize() with { op == UART_TX; data == 8'h0A; })
            `uvm_error("UART_SEQ", "Randomization failed")
        finish_item(item);
    endtask
    
endclass : uart_string_tx_seq

//==============================================================================
// All Bytes TX Sequence (0x00 to 0xFF)
//==============================================================================

class uart_all_bytes_tx_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_all_bytes_tx_seq)
    
    function new(string name = "uart_all_bytes_tx_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        `uvm_info("UART_SEQ", "Sending all byte values (0x00-0xFF)", UVM_MEDIUM)
        
        for (int i = 0; i < 256; i++) begin
            item = uart_seq_item::type_id::create("item");
            start_item(item);
            
            if (!item.randomize() with {
                op == UART_TX;
                data == i[{{ data_bits }}-1:0];
            }) `uvm_error("UART_SEQ", "Randomization failed")
            
            finish_item(item);
        end
    endtask
    
endclass : uart_all_bytes_tx_seq

//==============================================================================
// Error Injection Sequence
//==============================================================================

class uart_error_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_error_seq)
    
    rand bit do_frame_error;
    rand bit do_parity_error;
    rand bit do_break;
    
    function new(string name = "uart_error_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        item = uart_seq_item::type_id::create("item");
        start_item(item);
        
        if (!item.randomize() with {
            op == UART_TX;
            inject_frame_error == do_frame_error;
            inject_parity_error == do_parity_error;
            inject_break == do_break;
        }) `uvm_error("UART_SEQ", "Randomization failed")
        
        finish_item(item);
        
        `uvm_info("UART_SEQ", $sformatf("Error injection: frame=%b parity=%b break=%b",
                  do_frame_error, do_parity_error, do_break), UVM_MEDIUM)
    endtask
    
endclass : uart_error_seq

//==============================================================================
// Baud Rate Change Sequence
//==============================================================================

class uart_baud_change_seq extends uart_base_seq;
    
    `uvm_object_utils(uart_baud_change_seq)
    
    int baud_rates[] = '{9600, 19200, 38400, 57600, 115200};
    
    function new(string name = "uart_baud_change_seq");
        super.new(name);
    endfunction
    
    task body();
        uart_seq_item item;
        
        foreach (baud_rates[i]) begin
            `uvm_info("UART_SEQ", $sformatf("Testing baud rate: %0d", baud_rates[i]), UVM_MEDIUM)
            
            // Send a few bytes at this baud rate
            repeat (5) begin
                item = uart_seq_item::type_id::create("item");
                start_item(item);
                
                if (!item.randomize() with {
                    op == UART_TX;
                    baud_rate == baud_rates[i];
                }) `uvm_error("UART_SEQ", "Randomization failed")
                
                finish_item(item);
            end
        end
    endtask
    
endclass : uart_baud_change_seq
