//------------------------------------------------------------------------------
// UART Sequence Item
// Auto-generated by VerifAI
//------------------------------------------------------------------------------

class uart_seq_item extends uvm_sequence_item;
    
    //--------------------------------------------------------------------------
    // Transaction Fields
    //--------------------------------------------------------------------------
    
    // Data
    rand logic [{{ data_bits }}-1:0] data;
    
    // Operation type
    rand uart_op_e op;
    
    // Configuration
    rand parity_type_e parity;
    rand int baud_rate;
    
    // Error injection
    rand bit inject_frame_error;
    rand bit inject_parity_error;
    rand bit inject_break;
    
    // Response fields
    logic [{{ data_bits }}-1:0] rx_data;
    uart_error_e error;
    
    // Timing
    time start_time;
    time end_time;
    
    //--------------------------------------------------------------------------
    // Constraints
    //--------------------------------------------------------------------------
    
    constraint c_default_config {
        soft parity == PARITY_{% if parity == 'none' %}NONE{% elif parity == 'even' %}EVEN{% elif parity == 'odd' %}ODD{% else %}NONE{% endif %};
        soft baud_rate == {{ baud_rate }};
    }
    
    constraint c_no_errors {
        soft inject_frame_error == 0;
        soft inject_parity_error == 0;
        soft inject_break == 0;
    }
    
    constraint c_valid_baud {
        baud_rate inside {9600, 19200, 38400, 57600, 115200, 230400, 460800, 921600};
    }
    
    //--------------------------------------------------------------------------
    // UVM Macros
    //--------------------------------------------------------------------------
    
    `uvm_object_utils_begin(uart_seq_item)
        `uvm_field_int(data, UVM_ALL_ON)
        `uvm_field_enum(uart_op_e, op, UVM_ALL_ON)
        `uvm_field_enum(parity_type_e, parity, UVM_ALL_ON)
        `uvm_field_int(baud_rate, UVM_ALL_ON)
        `uvm_field_int(inject_frame_error, UVM_ALL_ON)
        `uvm_field_int(inject_parity_error, UVM_ALL_ON)
        `uvm_field_int(inject_break, UVM_ALL_ON)
        `uvm_field_int(rx_data, UVM_ALL_ON | UVM_NOCOMPARE)
        `uvm_field_enum(uart_error_e, error, UVM_ALL_ON | UVM_NOCOMPARE)
    `uvm_object_utils_end
    
    //--------------------------------------------------------------------------
    // Constructor
    //--------------------------------------------------------------------------
    
    function new(string name = "uart_seq_item");
        super.new(name);
    endfunction
    
    //--------------------------------------------------------------------------
    // Convert to String
    //--------------------------------------------------------------------------
    
    function string convert2string();
        string s;
        s = $sformatf("UART %s: data=0x%02h", op.name(), data);
        if (parity != PARITY_NONE)
            s = {s, $sformatf(" parity=%s", parity.name())};
        s = {s, $sformatf(" baud=%0d", baud_rate)};
        if (inject_frame_error)
            s = {s, " [FRAME_ERR]"};
        if (inject_parity_error)
            s = {s, " [PARITY_ERR]"};
        if (inject_break)
            s = {s, " [BREAK]"};
        if (error != ERR_NONE)
            s = {s, $sformatf(" error=%s", error.name())};
        return s;
    endfunction
    
endclass : uart_seq_item
