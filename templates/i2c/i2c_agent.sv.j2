//------------------------------------------------------------------------------
// I2C Agent
// Generated by VerifAI - Natural Language to UVM Testbench Generator
//------------------------------------------------------------------------------

`ifndef I2C_AGENT_SV
`define I2C_AGENT_SV

class i2c_agent extends uvm_agent;
    
    `uvm_component_utils(i2c_agent)
    
    //--------------------------------------------------------------------------
    // Components
    //--------------------------------------------------------------------------
    i2c_driver    driver;
    i2c_monitor   monitor;
    i2c_sequencer sequencer;
    
    //--------------------------------------------------------------------------
    // Configuration
    //--------------------------------------------------------------------------
    uvm_active_passive_enum is_active = UVM_ACTIVE;
    bit is_master = 1;  // Master or slave agent
    
    //--------------------------------------------------------------------------
    // Analysis Port (passthrough from monitor)
    //--------------------------------------------------------------------------
    uvm_analysis_port #(i2c_seq_item) item_collected_port;
    
    //--------------------------------------------------------------------------
    // Constructor
    //--------------------------------------------------------------------------
    
    function new(string name = "i2c_agent", uvm_component parent = null);
        super.new(name, parent);
    endfunction
    
    //--------------------------------------------------------------------------
    // Build Phase
    //--------------------------------------------------------------------------
    
    virtual function void build_phase(uvm_phase phase);
        super.build_phase(phase);
        
        // Always create monitor
        monitor = i2c_monitor::type_id::create("monitor", this);
        
        // Create driver and sequencer only if active
        if (is_active == UVM_ACTIVE) begin
            driver = i2c_driver::type_id::create("driver", this);
            sequencer = i2c_sequencer::type_id::create("sequencer", this);
        end
        
        // Create analysis port
        item_collected_port = new("item_collected_port", this);
    endfunction
    
    //--------------------------------------------------------------------------
    // Connect Phase
    //--------------------------------------------------------------------------
    
    virtual function void connect_phase(uvm_phase phase);
        super.connect_phase(phase);
        
        // Connect driver to sequencer if active
        if (is_active == UVM_ACTIVE) begin
            driver.seq_item_port.connect(sequencer.seq_item_export);
            driver.is_master = this.is_master;
        end
        
        // Connect monitor analysis port
        monitor.item_collected_port.connect(this.item_collected_port);
    endfunction
    
    //--------------------------------------------------------------------------
    // Get Methods
    //--------------------------------------------------------------------------
    
    function i2c_sequencer get_sequencer();
        return sequencer;
    endfunction
    
endclass : i2c_agent

`endif // I2C_AGENT_SV
